{"version":3,"names":["AuthError","RSAVerifier","base64","jwtDecoder","require","ALLOWED_ALGORITHMS","verifySignature","idToken","options","header","payload","err","Promise","reject","idTokenError","error","desc","alg","includes","resolve","getJwk","domain","kid","then","jwk","rsaVerifier","rsaVerifierForKey","encodedParts","split","headerAndPayload","signature","decodeToHEX","verify","modulus","n","exponent","e","getJwksUri","uri","fetchJson","keys","key","filter","k","use","kty","find","Error","catch","fetch","resp","json","openIdConfig","jwks_uri","error_description","status"],"sourceRoot":"../../../src","sources":["jwt/signatureVerifier.ts"],"mappings":"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"}